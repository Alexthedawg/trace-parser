Author: Alex Wang axw582           Date: 15 Dec 2022

******************************************************************************************************

The tool to help parse the contents of a network tracefile (ipv4) -- can be run in 3 different modes:

usage: ./proj4 -t trace_file -s|-l|-p

******************************************************************************************************

-s: prints the following information to stdout.

FIRST PKT: first_time
LAST PKT: last_time
TOTAL PACKETS: total_pkts
IP PACKETS: ip_pkts

******************************************************************************************************

-l: prints the following information about each packet to stdout.
[timestamp] [cap_len] [ipv4_len] [ipheader_len] [transport_proto] [transport_header_len] [payload_len]

timestamp:            timestamp field in the packet
cap_len:              total length (in bytes) captured by packet trace
ipv4_len:             total length of the ipv4 packet
ipheader_len:         total length of the ipv4 header
transport_proto:      transport protocol for packet (T - TCP; U - UDP; ? - other)
transport_header_len: total length of transport header
payload_len:          total payload of each packet, excluding header bytes

******************************************************************************************************

-p: prints the following information about each TCP packet to stdout.
[timestamp] [src_ip] [des_ip] [ip_ttl] [src_port] [des_port] [window] [seqno] [ackno]

timestamp: timestamp field in the packet
src_ip:    the source's ipv4 address
des_ip:    the destination's ipv4 address
ip_ttl:    the ipv4's TTL field
src_port:  the source's port number
des_port:  the destination's port number
window:    the TCP header's window field
seqno:     the TCP header's sequence number
ackno:     the TCP header's acknowledgment number

******************************************************************************************************

Some examples of output:

:~/trace-parser$ ./trace-parser -t tests/many.trace -s
FIRST PKT: 1265333451.765986
LAST PKT: 1265338613.787356
TOTAL PACKETS: 5000
IP PACKETS: 5000

:~/trace-parser$ ./trace-parser -t tests/30pkts.trace -l
1265333451.765986 66 52 20 T 32 0
1265333452.013216 66 1500 20 T 32 1448
1265333452.013255 66 1500 20 T 32 1448
1265333452.085174 66 1500 20 T 32 1448
1265333452.085186 66 1500 20 T 32 1448
1265333452.085203 66 1500 20 T 32 1448
1265333452.157256 66 1500 20 T 32 1448
1265333452.157267 66 1500 20 T 32 1448
1265333452.157279 66 1500 20 T 32 1448
1265333452.157292 66 1500 20 T 32 1448
1265333452.157308 66 1500 20 T 32 1448
1265333452.178767 42 268 20 U 8 240
1265333452.229256 66 1500 20 T 32 1448
1265333452.229287 66 1500 20 T 32 1448
1265333452.229983 66 1500 20 T 32 1448
1265333452.229994 66 1500 20 T 32 1448
1265333452.230008 66 1500 20 T 32 1448
1265333452.230026 66 1500 20 T 32 1448
1265333452.230046 66 1500 20 T 32 1448
1265333452.233418 74 60 20 T 40 0
1265333452.233706 74 60 20 T 40 0
1265333452.237836 66 52 20 T 32 0
1265333452.238131 66 332 20 T 32 280
1265333452.238262 66 1500 20 T 32 1448
1265333452.238345 66 52 20 T 32 0
1265333452.238443 66 351 20 T 32 299
1265333452.238636 66 1500 20 T 32 1448
1265333452.242692 66 1500 20 T 32 1448
1265333452.242786 66 1500 20 T 32 1448

:~/trace-parser$ ./trace-parser -t tests/30pkts.trace -p
1265333451.765986 206.190.52.34 192.168.77.115 49 80 51423 2801515435 2701884736
1265333452.013216 206.190.52.34 192.168.77.115 49 80 51423 2801515435 2701884736
1265333452.013255 206.190.52.34 192.168.77.115 49 80 51423 2801516883 2701884736
1265333452.085174 206.190.52.34 192.168.77.115 49 80 51423 2801518331 2701884736
1265333452.085186 206.190.52.34 192.168.77.115 49 80 51423 2801519779 2701884736
1265333452.085203 206.190.52.34 192.168.77.115 49 80 51423 2801521227 2701884736
1265333452.157256 206.190.52.34 192.168.77.115 49 80 51423 2801522675 2701884736
1265333452.157267 206.190.52.34 192.168.77.115 49 80 51423 2801524123 2701884736
1265333452.157279 206.190.52.34 192.168.77.115 49 80 51423 2801525571 2701884736
1265333452.157292 206.190.52.34 192.168.77.115 49 80 51423 2801527019 2701884736
1265333452.157308 206.190.52.34 192.168.77.115 49 80 51423 2801528467 2701884736
1265333452.229256 206.190.52.34 192.168.77.115 49 80 51423 2801529915 2701884736
1265333452.229287 206.190.52.34 192.168.77.115 49 80 51423 2801531363 2701884736
1265333452.229983 206.190.52.34 192.168.77.115 49 80 51423 2801532811 2701884736
1265333452.229994 206.190.52.34 192.168.77.115 49 80 51423 2801534259 2701884736
1265333452.230008 206.190.52.34 192.168.77.115 49 80 51423 2801535707 2701884736
1265333452.230026 206.190.52.34 192.168.77.115 49 80 51423 2801537155 2701884736
1265333452.230046 206.190.52.34 192.168.77.115 49 80 51423 2801538603 2701884736
1265333452.233418 98.137.88.83 192.168.77.115 54 80 51424 718834593 270413782
1265333452.233706 98.137.88.83 192.168.77.115 54 80 51425 745572785 438818054
1265333452.237836 98.137.88.83 192.168.77.115 54 80 51425 745572786 438818505
1265333452.238131 98.137.88.83 192.168.77.115 54 80 51425 745572786 438818505
1265333452.238262 98.137.88.83 192.168.77.115 54 80 51425 745573066 438818505
1265333452.238345 98.137.88.83 192.168.77.115 54 80 51424 718834594 270414567
1265333452.238443 98.137.88.83 192.168.77.115 54 80 51424 718834594 270414567
1265333452.238636 98.137.88.83 192.168.77.115 54 80 51424 718834893 270414567
1265333452.242692 98.137.88.83 192.168.77.115 54 80 51425 745574514 438818505
1265333452.242786 98.137.88.83 192.168.77.115 54 80 51425 745575962 438818505
